(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      7309,        242]
NotebookOptionsPosition[      6084,        193]
NotebookOutlinePosition[      6436,        209]
CellTagsIndexPosition[      6393,        206]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], "\n", 
 RowBox[{
  RowBox[{"$Assumptions", "=", "True"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6467317308555613`*^9, 3.6467317308569393`*^9}}],

Cell[CellGroupData[{

Cell["Volume of a 3D-ball in Spherical Coordinates", "Title",
 CellChangeTimes->{3.6467321640536947`*^9}],

Cell[CellGroupData[{

Cell["Statement", "Chapter",
 CellChangeTimes->{{3.646732353246928*^9, 3.6467323552047443`*^9}}],

Cell["Consider a ball of radius r. Then, calculate its volume.", "Text",
 CellChangeTimes->{{3.64673146010542*^9, 3.646731468703113*^9}, {
  3.6467322735468683`*^9, 3.646732316678165*^9}, {3.646732360232128*^9, 
  3.64673236162241*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solution:", "Chapter",
 CellChangeTimes->{{3.646732365959586*^9, 3.646732369868623*^9}}],

Cell["\<\
First, calculate the metric tensor coefficients in spherical coordinates:\
\>", "Text",
 CellChangeTimes->{{3.646732372828771*^9, 3.646732398051578*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"metric", "[", 
   RowBox[{"\[Rho]_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
  RowBox[{"CoordinateChartData", "[", 
   RowBox[{"\"\<Spherical\>\"", ",", " ", "\"\<Metric\>\"", ",", 
    RowBox[{"{", 
     RowBox[{"\[Rho]", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.646731168065898*^9, 3.646731203649831*^9}, {
  3.6467314722671833`*^9, 3.646731495130741*^9}, {3.646731564334133*^9, 
  3.6467315682437983`*^9}}],

Cell["\<\
Then, calculate the square root of the metric determinant to have the volume \
scale value (because not all of the spherical coordinates measure lengths):\
\>", "Text",
 CellChangeTimes->{{3.646732405883349*^9, 3.646732464513447*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f", "=", 
  RowBox[{"Sqrt", "[", 
   RowBox[{"Det", "[", 
    RowBox[{"metric", "[", 
     RowBox[{"\[Rho]", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.646731603977087*^9, 3.646731654598143*^9}}],

Cell[BoxData[
 SqrtBox[
  RowBox[{
   SuperscriptBox["\[Rho]", "4"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]]], "Output",
 CellChangeTimes->{{3.646731607350646*^9, 3.646731663016734*^9}, 
   3.646731736192729*^9, 3.646736248644418*^9}]
}, Open  ]],

Cell["\<\
Finally, calculate the ball volume as the integration of a region:\
\>", "Text",
 CellChangeTimes->{{3.646732469601468*^9, 3.6467325014241323`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"volball", "=", 
  RowBox[{"Integrate", "[", 
   RowBox[{"f", ",", 
    RowBox[{"{", 
     RowBox[{"\[Rho]", ",", "0", ",", "r"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "0", ",", "Pi"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", " ", 
      RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.646731160811039*^9, 3.6467311643292847`*^9}, {
  3.64673121157775*^9, 3.6467312875835857`*^9}, {3.646731506076597*^9, 
  3.646731586524127*^9}, {3.646731672438285*^9, 3.646731672938415*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"4", " ", "\[Pi]", " ", 
   SuperscriptBox["r", "3"]}], "3"]], "Output",
 CellChangeTimes->{3.646731288586434*^9, 3.646731537626266*^9, 
  3.6467315883617487`*^9, 3.646731673605358*^9, 3.646731736238842*^9, 
  3.646736248785904*^9}]
}, Open  ]],

Cell["\<\
As a side note, the last integration limit can be changed to make all the \
integration limits look more symmetrical (they all from 0):\
\>", "Text",
 CellChangeTimes->{{3.646736270390306*^9, 3.646736346068351*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"volball", "=", 
  RowBox[{"Integrate", "[", 
   RowBox[{"f", ",", 
    RowBox[{"{", 
     RowBox[{"\[Rho]", ",", "0", ",", "r"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "0", ",", "Pi"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", " ", "0", ",", 
      RowBox[{"2", " ", "Pi"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.646736257600556*^9, 3.6467362606163893`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"4", " ", "\[Pi]", " ", 
   SuperscriptBox["r", "3"]}], "3"]], "Output",
 CellChangeTimes->{3.646736261245969*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Convention", "Chapter",
 CellChangeTimes->{{3.64673233756746*^9, 3.646732339358366*^9}}],

Cell[TextData[{
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " uses the ISO-2:2009 (physics) convention for spherical coordinates: \
(rho,theta,phi): rho: radial distance, theta: inclination (aka, \
zenith/colatitude/polar angle), and phi: azimuth (aka, longitude):"
}], "Text",
 CellChangeTimes->{{3.646731327139357*^9, 3.646731418288818*^9}, {
  3.646732179012789*^9, 3.646732194081773*^9}, {3.646732231610545*^9, 
  3.646732264239678*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CoordinateChartData", "[", 
  RowBox[{
   RowBox[{"{", "\"\<Spherical\>\"", "}"}], ",", 
   "\"\<CoordinateRangeAssumptions\>\"", ",", 
   RowBox[{"{", 
    RowBox[{"\[Rho]", ",", "\[Theta]", ",", "\[Phi]"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6467280028873873`*^9, 3.646728062716723*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]", ">", "0"}], "&&", 
  RowBox[{"0", "<", "\[Theta]", "<", "\[Pi]"}], "&&", 
  RowBox[{
   RowBox[{"-", "\[Pi]"}], "<", "\[Phi]", "\[LessEqual]", 
   "\[Pi]"}]}]], "Output",
 CellChangeTimes->{3.646731143480199*^9, 3.646731736157628*^9, 
  3.6467362488154917`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{638, 755},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (June 27, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 210, 4, 46, "Input"],
Cell[CellGroupData[{
Cell[793, 28, 105, 1, 148, "Title"],
Cell[CellGroupData[{
Cell[923, 33, 96, 1, 65, "Chapter"],
Cell[1022, 36, 236, 3, 30, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1295, 44, 94, 1, 65, "Chapter"],
Cell[1392, 47, 163, 3, 30, "Text"],
Cell[1558, 52, 506, 11, 46, "Input"],
Cell[2067, 65, 244, 4, 49, "Text"],
Cell[CellGroupData[{
Cell[2336, 73, 274, 7, 28, "Input"],
Cell[2613, 82, 270, 7, 40, "Output"]
}, Open  ]],
Cell[2898, 92, 158, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[3081, 99, 578, 13, 28, "Input"],
Cell[3662, 114, 270, 6, 50, "Output"]
}, Open  ]],
Cell[3947, 123, 225, 4, 49, "Text"],
Cell[CellGroupData[{
Cell[4197, 131, 437, 11, 28, "Input"],
Cell[4637, 144, 152, 4, 50, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[4838, 154, 94, 1, 65, "Chapter"],
Cell[4935, 157, 447, 9, 68, "Text"],
Cell[CellGroupData[{
Cell[5407, 170, 329, 8, 46, "Input"],
Cell[5739, 180, 305, 8, 28, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
